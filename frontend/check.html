<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>重機在庫チェックシート（仕切り付き）</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 1000px; margin: auto; }
        table { width: 100%; border-collapse: collapse; background: white; }
        th, td { border: 1px solid #ccc; padding: 8px; }
        th { background-color: #004085; color: white; position: sticky; top: 0; z-index: 10; }
        
        /* 型式の変わり目の行スタイル */
        .section-divider {
            background-color: #e2e8f0;
            font-weight: bold;
            color: #1e293b;
            text-align: left;
            padding: 10px;
        }
        .section-divider td { border-top: 3px solid #64748b; }

        .spec-cell { background-color: #f8fafc; color: #64748b; font-size: 13px; width: 100px; }
        tr:hover { background-color: #f1f5f9; }
        select, input { width: 95%; padding: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h1>重機在庫チェックシート</h1>
    
    <table id="checkSheet">
        <thead>
            <tr>
                <th style="width: 80px;">機番</th>
                <th>アタッチメント</th>
                <th>点検状態</th>
                <th>備考</th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>
</div>

<script>
    // マシン情報の定義
    function getMachineSpec(no) {
        if (no >= 100 && no <= 110) return { model: "ZX110", spec: "0.4㎥" };
        if (no >= 111 && no <= 120) return { model: "ZX135US", spec: "0.5㎥" };
        if (no >= 121 && no <= 140) return { model: "ZX200", spec: "0.8㎥" };
        return { model: "その他", spec: "-" };
    }

    const attachments = ["標準バケット", "ブレーカー", "フォーク", "グラップル"];
    const statuses = ["良", "要点検", "修理中", "未実施"];
    const tbody = document.querySelector("#checkSheet tbody");

    let lastModel = ""; // 直前の型式を記録しておく変数

    for (let no = 100; no <= 140; no++) {
        const specData = getMachineSpec(no);

        // 【重要】型式が変わったら仕切り行を追加
        if (specData.model !== lastModel) {
            const divider = document.createElement("tr");
            divider.className = "section-divider";
            divider.innerHTML = `<td colspan="4">■ ${specData.model} (${specData.spec})</td>`;
            tbody.appendChild(divider);
            
            lastModel = specData.model; // 現在の型式を記録
        }

        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td style="text-align:center;"><strong>${no}</strong></td>
            <td>
                <select>
                    <option value="">選択...</option>
                    ${attachments.map(a => `<option value="${a}">${a}</option>`).join('')}
                </select>
            </td>
            <td>
                <select>
                    <option value="">選択...</option>
                    ${statuses.map(s => `<option value="${s}">${s}</option>`).join('')}
                </select>
            </td>
            <td><input type="text"></td>
        `;
        tbody.appendChild(tr);
    }
</script>
</body>
</html>
